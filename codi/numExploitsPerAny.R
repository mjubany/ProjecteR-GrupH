install.packages("dplyr")
install.packages("lubridate") #Per treballar amb dates

library(dplyr)
library(lubridate)
library(ggplot)

exploitsData <- read.csv(file="C:/Users/Carles/Documents/exploitDataSet.csv", header=TRUE, sep=",")

dataFiltered <- dplyr::select(exploitsData, date, author)

#yearsLabel <- sort(unique(year(dataFiltered$date)), decreasing = FALSE)
yearsLabel <- min(year(dataFiltered$date)):max(year(dataFiltered$date))

yearsTable <- table(yearsLabel) - 1

#dataTable <- table(dataFiltered)
#authorsDistinct <- unique(dataFiltered)
#vector <- rep(1,length(years))



for (exploitDate in dataFiltered$date) {
  yearsTable[names(yearsTable)==year(exploitDate)] <- yearsTable[names(yearsTable)==year(exploitDate)] + 1
}

df <- data.frame(anys=yearsLabel,
                 exploits=as.vector(yearsTable))

ggplot(data=df, aes(x=anys, y=exploits)) +
  geom_bar(stat="identity", fill="steelblue")+
  geom_text(aes(label=exploits), vjust=-0.3, size=3.5)+
  theme_minimal()
